<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Painel de Status - Servidores Minecraft</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 text-gray-900 min-h-screen">
  <div class="max-w-xl mx-auto p-6">
    <h1 class="text-3xl font-bold mb-6 text-center">Status de Servidor Minecraft</h1>

    <div class="mb-6 flex gap-2">
      <input id="hostInput" class="flex-1 border p-2 rounded" placeholder="ex.: mc.hypixel.net" value="mc.universocraft.com">
      <button id="applyBtn" class="bg-blue-600 text-white px-4 py-2 rounded">Verificar</button>
    </div>

    <div id="statusSection" class="bg-white p-4 rounded shadow space-y-3">
      <div><strong>Status:</strong> <span id="statusText">–</span></div>
      <div><strong>Jogadores:</strong> <span id="playersNow">–</span> / <span id="playersMax">–</span></div>
      <div><strong>Versão:</strong> <span id="version">–</span></div>
      <div><strong>MOTD:</strong> <pre id="motd" class="whitespace-pre-wrap"></pre></div>
      <div><strong>IP / Porta:</strong> <span id="ipPort">–</span></div>
      <div><strong>Última atualização:</strong> <span id="lastUpdate">–</span></div>
    </div>
  </div>

  <script>
    const API = "https://api.mcsrvstat.us/3/";

    const hostInput = document.getElementById('hostInput');
    const applyBtn = document.getElementById('applyBtn');
    const statusText = document.getElementById('statusText');
    const playersNow = document.getElementById('playersNow');
    const playersMax = document.getElementById('playersMax');
    const versionEl = document.getElementById('version');
    const motdEl = document.getElementById('motd');
    const ipPortEl = document.getElementById('ipPort');
    const lastUpdate = document.getElementById('lastUpdate');

    async function fetchStatus(host) {
      try {
        const res = await fetch(API + encodeURIComponent(host));
        const data = await res.json();

        statusText.textContent = data.online ? "Online" : "Offline";
        playersNow.textContent = data.players?.online ?? 0;
        playersMax.textContent = data.players?.max ?? "–";
        versionEl.textContent = data.version || "–";
        motdEl.textContent = (Array.isArray(data.motd?.clean) ? data.motd.clean.join("\n") : data.motd?.clean) || "";
        ipPortEl.textContent = (data.ip || host) + (data.port ? ":" + data.port : "");
        lastUpdate.textContent = new Date().toLocaleString();
      } catch {
        statusText.textContent = "Erro ao buscar informações";
      }
    }

    applyBtn.onclick = () => {
      const host = hostInput.value.trim();
      if (!host) return;
      fetchStatus(host);
    };

    // Atualiza automaticamente a cada 30s
    setInterval(() => fetchStatus(hostInput.value.trim()), 30000);
    fetchStatus(hostInput.value.trim());
  </script>
</body>
</html>
